{"version":3,"file":"arizona-worker.min.js","sources":["assets/js/client/arizona-hierarchical.js","assets/js/client/arizona-worker.js"],"sourcesContent":["/**\n * Arizona Hierarchical Client\n *\n * Standalone module for managing hierarchical structures and HTML generation.\n * Used by both arizona-worker.js and arizona.js for consistent structure handling.\n *\n * Features:\n * - Initialize with hierarchical structures from WebSocket\n * - Apply diffs from arizona_differ to update structures\n * - Generate HTML from hierarchical structures\n * - Support for nested stateful/stateless components and lists\n */\n\n/**\n * ArizonaHierarchical - Client-side hierarchical structure manager\n */\nexport default class ArizonaHierarchical {\n  constructor() {\n    this.structure = new Map();\n  }\n\n  /**\n   * Initialize with hierarchical structure from server\n   * @param {Object} structure - Hierarchical structure from arizona_hierarchical\n   */\n  initialize(structure) {\n    this.structure = new Map(Object.entries(JSON.parse(JSON.stringify(structure)))); // Deep clone and convert to Map\n  }\n\n  /**\n   * Merge new structures from fingerprint mismatches into existing Map\n   * @param {Object} newStructures - New structures from arizona_hierarchical_dict\n   */\n  mergeStructures(newStructures) {\n    for (const [id, data] of Object.entries(newStructures)) {\n      this.structure.set(id, data);\n    }\n  }\n\n  /**\n   * Apply diff changes from arizona_differ to hierarchical structure\n   * @param {string} statefulId - Stateful ID to render\n   * @param {Array|Object} changes - Changes in format: [[ElementIndex, Changes]] or hierarchical structure\n   */\n  applyDiff(statefulId, changes) {\n    // Check if changes is a hierarchical structure (fingerprint mismatch case)\n    if (changes?.type === 'stateful') {\n      this.structure.set(changes.id, changes);\n      return;\n    }\n\n    if (!this.structure.has(statefulId)) {\n      const sanitizedStatefulId = String(statefulId).replace(/\\r|\\n/g, '');\n      console.warn(`[Arizona] StatefulId '${sanitizedStatefulId}' not found in structure`);\n    }\n\n    const component = this.structure.get(statefulId);\n    for (const [elementIndex, newValue] of changes) {\n      this.applyDiffValue(component.dynamic, elementIndex - 1, newValue);\n    }\n  }\n\n  /**\n   * Recursively apply a diff value to a container at a specific index\n   * Handles all types: hierarchical structures, lists, stateless components, and simple values\n   * @private\n   * @param {Array} container - The dynamic array to update\n   * @param {number} targetIndex - The index to update (0-based)\n   * @param {*} newValue - The new value to apply\n   * @returns {void}\n   */\n  applyDiffValue(container, targetIndex, newValue) {\n    const existing = container[targetIndex];\n\n    // Array of changes - apply to component\n    if (existing?.type && Array.isArray(newValue)) {\n      switch (existing.type) {\n        case 'stateful': {\n          // Fetch actual component from Map\n          const component = this.structure.get(existing.id);\n          if (!component) {\n            const sanitizedId = String(existing.id).replace(/\\r|\\n/g, '');\n            console.warn(`[Arizona] Component '${sanitizedId}' not found in structure`);\n            return;\n          }\n          // Apply nested diff\n          newValue.forEach(([index, value]) => {\n            this.applyDiffValue(component.dynamic, index - 1, value);\n          });\n          return;\n        }\n        case 'stateless':\n          // Apply nested diff to inline component\n          newValue.forEach(([index, value]) => {\n            this.applyDiffValue(existing.dynamic, index - 1, value);\n          });\n          return;\n        case 'list':\n          // Replace list dynamic content\n          existing.dynamic = newValue;\n          return;\n      }\n    }\n\n    // Simple replacement - new reference or simple value\n    container[targetIndex] = newValue;\n  }\n\n  /**\n   * Generate HTML for stateful components\n   * @param {Object} element - Stateful element with id\n   * @returns {string} Generated HTML\n   */\n  generateStatefulHTML(statefulId) {\n    const struct = this.structure.get(statefulId);\n    if (!struct) {\n      const sanitizedStatefulId = String(statefulId).replace(/\\r|\\n/g, '');\n      console.warn(`[Arizona] StatefulId '${sanitizedStatefulId}' not found in structure`);\n      throw new Error(`Component ${sanitizedStatefulId} not found`);\n    }\n\n    // Components always have static and dynamic arrays\n    const html = this.zipStaticDynamic(struct.static, struct.dynamic);\n    return html;\n  }\n\n  /**\n   * Generate HTML for stateless components\n   * @param {Object} element - Stateless element with static and dynamic arrays\n   * @returns {string} Generated HTML\n   */\n  generateStatelessHTML(element) {\n    return this.zipStaticDynamic(element.static, element.dynamic);\n  }\n\n  /**\n   * Generate HTML for list components\n   * @param {Object} listElement - List element with static template and dynamic data\n   * @returns {string} Generated HTML\n   */\n  generateListHTML(listElement) {\n    const { static: staticParts, dynamic: dynamicPartsList } = listElement;\n    return dynamicPartsList.reduce((acc, dynamicParts) => {\n      return acc + this.zipStaticDynamic(staticParts, dynamicParts);\n    }, '');\n  }\n\n  /**\n   * Zip static and dynamic arrays into HTML (matches arizona_renderer:zip_static_dynamic/2)\n   * @param {Array} staticParts - Static HTML parts\n   * @param {Array} dynamicParts - Dynamic content parts\n   * @returns {string} Generated HTML\n   */\n  zipStaticDynamic(staticParts, dynamicParts) {\n    const elements = [];\n    const maxLength = Math.max(staticParts.length, dynamicParts.length);\n\n    for (let i = 0; i < maxLength; i++) {\n      if (i < staticParts.length) {\n        elements.push(staticParts[i]);\n      }\n      if (i < dynamicParts.length) {\n        elements.push(this.normalizeDynamicElement(dynamicParts[i]));\n      }\n    }\n\n    return elements.join('');\n  }\n\n  /**\n   * Normalize a dynamic element to string (handles stateful, stateless, lists, etc.)\n   * @param {*} element - Dynamic element to normalize\n   * @returns {string} Normalized string content\n   */\n  normalizeDynamicElement(element) {\n    if (typeof element === 'string') {\n      return element;\n    } else if (element && element.type === 'stateful') {\n      // Recursively render nested stateful component\n      return this.generateStatefulHTML(element.id);\n    } else if (element && element.type === 'stateless') {\n      // Render stateless structure inline\n      return this.generateStatelessHTML(element);\n    } else if (element && element.type === 'list') {\n      // Render list elements\n      return this.generateListHTML(element);\n    } else if (Array.isArray(element)) {\n      // Handle nested arrays (iodata from server) - flatten recursively\n      return this.flattenIoData(element);\n    } else {\n      // Fallback for other types (numbers, etc.)\n      return String(element);\n    }\n  }\n\n  /**\n   * Flatten nested arrays (iodata from Erlang server) into a single string\n   * This handles the complex nested array structures that come from render_list\n   * and other server-side rendering operations that produce iodata.\n   *\n   * @param {Array|string|number} element - Element to flatten\n   * @returns {string} Flattened string without commas between array elements\n   */\n  flattenIoData(element) {\n    if (typeof element === 'string') {\n      return element;\n    } else if (typeof element === 'number') {\n      return String(element);\n    } else if (Array.isArray(element)) {\n      // Recursively flatten nested arrays\n      return element\n        .map((item) => {\n          return this.flattenIoData(item);\n        })\n        .join('');\n    } else if (element && typeof element === 'object') {\n      // Handle special object types\n      if (element.type === 'stateful') {\n        return this.generateStatefulHTML(element.id);\n      } else if (element.type === 'stateless') {\n        return this.generateStatelessHTML(element);\n      } else if (element.type === 'list') {\n        return this.generateListHTML(element);\n      } else {\n        // For other objects, try to convert to string\n        return String(element);\n      }\n    } else {\n      // Fallback for null, undefined, etc.\n      return String(element || '');\n    }\n  }\n\n  /**\n   * Get current structure (for debugging/testing)\n   * @returns {Object} Deep copy of current structure\n   */\n  getStructure() {\n    return JSON.parse(JSON.stringify(Object.fromEntries(this.structure)));\n  }\n\n  /**\n   * Check if structure has been initialized\n   * @returns {boolean} True if structure contains any components\n   */\n  isInitialized() {\n    return this.structure.size > 0;\n  }\n\n  /**\n   * Get all component IDs\n   * @returns {string[]} Array of all component IDs\n   */\n  getComponentIds() {\n    return Array.from(this.structure.keys());\n  }\n\n  /**\n   * Clear all structure data\n   */\n  clear() {\n    this.structure = new Map();\n  }\n\n  /**\n   * Create a patch object that can be sent to arizona.js for DOM updating\n   * This is used by the worker to send structured data to the main thread\n   * @param {string} statefulId - Stateful ID to render\n   * @returns {Object} Patch object with statefulId and HTML\n   */\n  createPatch(statefulId) {\n    const html = this.generateStatefulHTML(statefulId);\n    return {\n      type: 'html_patch',\n      statefulId,\n      html,\n    };\n  }\n}\n","// Import ArizonaHierarchical for client-side structure management\nimport ArizonaHierarchical from './arizona-hierarchical.js';\n\n// Arizona Worker for WebSocket connection with hierarchical rendering\nclass ArizonaWorker {\n  constructor() {\n    this.socket = null;\n    this.connected = false;\n    this.messageQueue = [];\n    this.hierarchical = new ArizonaHierarchical();\n\n    self.onmessage = (event) => {\n      // Validate message structure\n      // Note: This is a dedicated worker, so messages can only come from the parent window\n      // Origin checking is not applicable for dedicated workers\n      if (!event.data || typeof event.data !== 'object' || !event.data.type) {\n        return;\n      }\n\n      const { type, data } = event.data;\n\n      switch (type) {\n        case 'connect':\n          this.connect(data.url, data.expectedHost);\n          break;\n        case 'send':\n          this.sendMessage(data);\n          break;\n        case 'disconnect':\n          this.disconnect();\n          break;\n      }\n    };\n  }\n\n  connect(url, expectedHost) {\n    if (this.connected) return;\n\n    // Validate WebSocket URL to prevent client-side request forgery\n    if (!this.isValidWebSocketUrl(url, expectedHost)) {\n      this.postMessage({\n        type: 'error',\n        data: { error: 'Invalid WebSocket URL' },\n      });\n      return;\n    }\n\n    this.socket = new WebSocket(url);\n\n    this.socket.onopen = () => {\n      this.connected = true;\n      this.postMessage({ type: 'status', data: { status: 'connected' } });\n      this.flushMessageQueue();\n    };\n\n    this.socket.onmessage = (event) => {\n      const message = JSON.parse(event.data);\n      this.handleWebSocketMessage(message);\n    };\n\n    this.socket.onclose = () => {\n      this.connected = false;\n      this.postMessage({ type: 'status', data: { status: 'disconnected' } });\n    };\n\n    this.socket.onerror = (error) => {\n      this.postMessage({ type: 'error', data: { error: error.toString() } });\n    };\n  }\n\n  isValidWebSocketUrl(url, expectedHost) {\n    try {\n      const parsedUrl = new URL(url);\n\n      // Only allow WebSocket protocols\n      if (parsedUrl.protocol !== 'ws:' && parsedUrl.protocol !== 'wss:') {\n        return false;\n      }\n\n      // Validate hostname matches expected host to prevent request forgery\n      // The expectedHost comes from window.location.host in the main thread\n      if (expectedHost && parsedUrl.host !== expectedHost) {\n        return false;\n      }\n\n      // Prevent path traversal attacks in the pathname\n      if (parsedUrl.pathname.includes('../') || parsedUrl.pathname.includes('..\\\\')) {\n        return false;\n      }\n\n      return true;\n    } catch {\n      return false;\n    }\n  }\n\n  sendMessage(data) {\n    const message = JSON.stringify(data);\n\n    if (this.connected && this.socket.readyState === WebSocket.OPEN) {\n      this.socket.send(message);\n    } else {\n      this.messageQueue.push(message);\n    }\n  }\n\n  flushMessageQueue() {\n    while (this.messageQueue.length > 0) {\n      const message = this.messageQueue.shift();\n      if (this.socket.readyState === WebSocket.OPEN) {\n        this.socket.send(message);\n      } else {\n        this.messageQueue.unshift(message);\n        break;\n      }\n    }\n  }\n\n  disconnect() {\n    if (this.socket) {\n      this.socket.close();\n      this.socket = null;\n    }\n    this.connected = false;\n    this.hierarchical.clear();\n  }\n\n  handleWebSocketMessage(message) {\n    try {\n      switch (message.type) {\n        case 'initial_render':\n          this.handleInitialRender(message);\n          break;\n        case 'diff':\n          this.handleDiff(message);\n          break;\n        case 'reload':\n          this.handleReload(message);\n          break;\n        case 'dispatch':\n          this.handleDispatch(message);\n          break;\n        case 'reply':\n          this.handleReply(message);\n          break;\n        case 'redirect':\n          this.handleRedirect(message);\n          break;\n        default:\n          this.handleUnknownMessage(message);\n      }\n    } catch (error) {\n      this.postMessage({\n        type: 'error',\n        data: { error: `Message handling failed: ${error.message}` },\n      });\n    }\n  }\n\n  handleInitialRender(message) {\n    // Initialize hierarchical structure\n    this.hierarchical.initialize(message.structure);\n  }\n\n  handleDiff(message) {\n    if (!this.hierarchical.isInitialized()) {\n      throw new Error('Hierarchical structure not initialized');\n    }\n\n    // Merge new structures from fingerprint mismatches\n    if (message.structure && Object.keys(message.structure).length > 0) {\n      this.hierarchical.mergeStructures(message.structure);\n    }\n\n    // Apply diff to hierarchical structure\n    this.hierarchical.applyDiff(message.stateful_id, message.changes);\n\n    // Create HTML patch\n    const patch = this.hierarchical.createPatch(message.stateful_id);\n\n    // Send to main thread for DOM application\n    this.postMessage({\n      type: 'html_patch',\n      data: { patch },\n    });\n  }\n\n  handleReload(message) {\n    // Send reload message to main thread\n    this.postMessage({\n      type: 'reload',\n      data: message,\n    });\n  }\n\n  handleDispatch(message) {\n    // Send dispatch event message to main thread\n    this.postMessage({\n      type: 'dispatch',\n      data: message,\n    });\n  }\n\n  handleReply(message) {\n    // Send reply message to main thread\n    this.postMessage({\n      type: 'reply',\n      data: message,\n    });\n  }\n\n  handleRedirect(message) {\n    // Send redirect message to main thread\n    this.postMessage({\n      type: 'redirect',\n      data: {\n        url: message.url,\n        target: message.target,\n      },\n    });\n  }\n\n  handleUnknownMessage(message) {\n    // Pass through other message types unchanged\n    this.postMessage(message);\n  }\n\n  postMessage(data) {\n    self.postMessage(data);\n  }\n}\n\nnew ArizonaWorker();\n"],"names":["ArizonaHierarchical","structure","newStructures","id","data","statefulId","changes","sanitizedStatefulId","component","elementIndex","newValue","container","targetIndex","existing","sanitizedId","index","value","struct","element","listElement","staticParts","dynamicPartsList","acc","dynamicParts","elements","maxLength","item","html","ArizonaWorker","event","type","url","expectedHost","message","error","parsedUrl","patch"],"mappings":"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"}